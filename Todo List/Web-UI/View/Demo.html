
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">

<title>iScroll demo: bounce easing</title>
<link rel="stylesheet" type="text/css" href="../Styles/Demo.css" />
<link rel="stylesheet" type="text/css" href="../Styles/animate.css" />
<!-- <link rel="stylesheet" type="text/css" href="../Styles/Todo.css" /> -->
<script type="text/javascript" src="../Scripts/jquery-1.8.js"></script>
<script type="text/javascript" src="../Scripts/jquery.transit.js"></script>
<script type="text/javascript" src="../Scripts/jquery.wipetouch.js"></script>
<script type="text/javascript" src="../Scripts/iScroll5/iscroll.js"></script>
<script type="text/javascript" src="../Scripts/Todo.js"></script>
<style type="text/css">
/* li { */
/* 	-vendor-animation-duration: 3s; */
/* 	-vendor-animation-delay: 2s; */
/* 	-vendor-animation-iteration-count: infinite; */
/* } */
li.added {
	-vendor-animation-duration: 3s;
	-vendor-animation-delay: 2s;
	-vendor-animation-iteration-count: infinite;
}
</style>
<script type="text/javascript">
	var myScroll;
	
	window.verticalSwipeDist  = 0;

	function loaded() {
		myScroll = new IScroll('#wrapper', {
			bounceEasing : 'elastic',
			bounceTime : 1200
		});
		/* myScroll.options.onBeforeScrollEnd = function(){
				alert("as");
				// Code for adding a task-li that appears in the top.
			} */
		
		positionOfFirstTile = $("#scroller").offset().top;
		
		myScroll.on('scrollStart', function() {
// 			debugger;
			positionOfFirstTile = $("#scroller").offset().top;
			$('#wrapper').on('vmouseup', function(e) {
				alert("Touch Start.");
				e.preventDefault();
			}, false);
		} );
		myScroll.on('scrollEnd', function() {
// 			debugger;
			if( $("#scroller").offset().top == 71 && positionOfFirstTile == 71 ){
				$('#wrapper').trigger('vmouseup');
				$('#wrapper').off('vmouseup');

				//If the vertically scrolled distance is <200px, don't render the Tile for the new task. 
				if(window.verticalSlideDist  < 200)
					return;
				
				/**
				 * Code for the text-box, to enter the Task-name and the description.
				 */
				var newTakHTML = '<li class="task added"><span class="tiles">'+
											'<div class="Name">New Task</div>'+
											'<div class="Description">Description</div>'+
									'</span></li>';
				
				// Add a new tile to the List, and bind an event listener for the slide-to-delete event.
				$("div#scroller ul").prepend(newTakHTML);
				$('li.task:first').dblclick(function(){
					console.log("dblClick");
					$(this).removeClass('animated bounceIn');
					$(this).addClass('animated tada');
					setTimeout( function(){
						$('li.task').removeClass('animated tada');
					}, 1000);
				})
				$("div#scroller ul li:first").wipetouch(
						{
							wipeLeft : function(result) {
								console.log("LEFT");
								var deletedTaskLi = $(result.source).parent().parent();
								
								if($(result.source).hasClass("tiles"))
									deletedTaskLi = $(result.source).parent();
								else if($(result.source).hasClass("task"))
									deletedTaskLi = $(result.source);
								
								debugger;
								debugger;
								deletedTaskLi.transit(  {
															marginLeft : 0,
															opacity: 1.00
														},
														"slow",
														function(){
															console.log("Swiped Left")
															//alert("Right")
														}
													);
								//console.log(result.x + " , " + result.y + " : " + result.speed);
							},
							wipeRight : function(result) {
								console.log("RIGHT");
								var takLi = $(result.source).parent().parent();
								if($(result.source).hasClass("tiles"))
									takLi = $(result.source).parent();
								else if($(result.source).hasClass("task"))
									takLi = $(result.source);
								debugger;
								debugger;
								takLi.transit({
													marginLeft : takLi.outerWidth() + 20,
													opacity: 0.25
												},
												"slow",
												function(){
													console.log("Swiped Right")
													//alert("Left")
												})
											.transit(
														{
															height: 0,
															padding: 0,
															margin: 0	//Reason for geany effect.
														},
														"slow",
														function() {
															debugger;
															var nextTask = takLi.next();
															nextTask.transit({ top: 0}, "fast");
															//takLi.remove();
														}
													);
								//console.log(result.x + " , " + result.y + " : " + result.speed);
							},
							wipeUp : function(result) {
								console.log("UP");
								console.log(result.x + " , " + result.y + " : "
										+ result.speed);
							},
							wipeDown : function(result) {
							},
							wipeMove : function(result) {
							}
						});
// 				$('div#scroller ul li["class!=added"]').transition({ y: '40px' });
				$('div#scroller ul li.added').addClass('animated bounceIn');
				$('div#scroller ul li.added').removeClass('added');
				myScroll.refresh();
				//alert("Touch End.");
			}
		});
	}

</script>

</head>
<body onload="loaded()">
	<div id="header">Todo List</div>

	<div id="wrapper">
		<div id="scroller">
			<ul>
				<li class="task"><span class="tiles">
						<div class="Name">Task 1</div>
						<div class="Description">This is the description of Task 1
							and its overflowing.</div>
				</span></li>
				<li class="task"><span class="tiles">
						<div class="Name">Task A</div>
						<div class="Description">This is the description of Task 1
							and its overflowing.</div>
				</span></li>
				<li class="task"><span class="tiles">
						<div class="Name">Task A</div>
						<div class="Description">This is the description of Task 1
							and its overflowing.</div>
				</span></li>
				<li class="task"><span class="tiles">
						<div class="Name">Task A</div>
						<div class="Description">This is the description of Task 1
							and its overflowing.</div>
				</span></li>
				<li class="task"><span class="tiles">
						<div class="Name">Task A</div>
						<div class="Description">This is the description of Task 1
							and its overflowing.</div>
				</span></li>
				<li class="task"><span class="tiles">
						<div class="Name">Task A</div>
						<div class="Description">This is the description of Task 1
							and its overflowing.</div>
				</span></li>
				<li class="task"><span class="tiles">
						<div class="Name">Task A</div>
						<div class="Description">This is the description of Task 1
							and its overflowing.</div>
				</span></li>
				<li class="task"><span class="tiles">
						<div class="Name">Task A</div>
						<div class="Description">This is the description of Task 1
							and its overflowing.</div>
				</span></li>
				<li class="task"><span class="tiles">
						<div class="Name">Task A</div>
						<div class="Description">This is the description of Task 1
							and its overflowing.</div>
				</span></li>
				<li class="task"><span class="tiles">
						<div class="Name"><a href="#z" data-rel="popup">nnnn</a>Task A</div>
						<div class="Description">This is the description of Task 1
							and its overflowing.</div>
				</span></li>

			</ul>
		</div>
	</div>
	<div data-role="popup" id="#z">
		<a href="#" data-rel="back" data-role="button" data-theme="a" data-icon="delete" data-iconpos="notext" class="ui-btn-right">Close</a>
		...popup contents go here...
	</div>
	
	<!-- <div id="footer"></div> -->

</body>
</html>